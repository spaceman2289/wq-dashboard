(()=>{"use strict";var t,e={982:(t,e,a)=>{a(577);var n=a(546),s=a(422),o=a(366),l=a(148),i=a(158),r=a.n(i);const d={91602:"#f44336",91404:"#4caf50",91601:"#2196f3",39481:"#ff9800",39485:"#9c27b0","John's Island":"#00bcd4","Munyon Island":"#ffeb3b",salinityEnvelope:"#c8e6c9"};var c=a(877),u=(a(509),a(958)),y=a(341);c.Z.register(y.Z);var p=a(328);const b=document.querySelectorAll("#dateRangeButtons > input"),f=document.querySelectorAll(".card.position-relative"),h=document.querySelectorAll("canvas"),g=[],m=async t=>{t=t?function(t){let e={};switch(t){case"YTD":const t=(0,n.Z)((0,o.Z)(),"yyyy-MM-dd");return{start:(0,n.Z)((0,l.Z)((0,o.Z)()),"yyyy-MM-dd"),end:t};case"1Y":e.years=-1;break;case"6M":e.months=-6;break;case"3M":e.months=-3;break;case"1M":e.months=-1;break;case"1W":e.weeks=-1}const a=(0,n.Z)((0,o.Z)(),"yyyy-MM-dd");return{start:(0,n.Z)((0,s.Z)((0,o.Z)(),e),"yyyy-MM-dd"),end:a}}(t):{start:(0,n.Z)((0,s.Z)((0,o.Z)(),{months:-1}),"yyyy-MM-dd"),end:(0,n.Z)((0,o.Z)(),"yyyy-MM-dd")};const e=await(async t=>{b.forEach((t=>t.setAttribute("disabled","disabled"))),h.forEach((t=>t.classList.add("invisible"))),f.forEach((t=>t.classList.add("shimmer")));const e=await fetch(`/api/data/${t.start}/${t.end}`);b.forEach((t=>t.removeAttribute("disabled"))),h.forEach((t=>t.classList.remove("invisible"))),f.forEach((t=>t.classList.remove("shimmer")));let a=null;return 204===e.status?alert(`No data found between ${t.start} and ${t.end}.`):e.ok?a=e.json():alert("An unexpected error occured. Could not fetch data."),a})(t);e&&(g.forEach((t=>t.destroy())),function(t,e){c.Z.defaults.interaction={mode:"index",intersect:!1},c.Z.defaults.maintainAspectRatio=!1,c.Z.defaults.datasets.line.pointRadius=0,c.Z.defaults.plugins.title.display=!0,c.Z.defaults.plugins.title.position="left",c.Z.defaults.plugins.title.font.size=24,c.Z.defaults.plugins.title.font.weight="bold",c.Z.defaults.plugins.legend.labels.boxHeight=0,c.Z.defaults.plugins.tooltip.callbacks.label=t=>{const e="psu"===t.dataset.unit.toLowerCase()?"":` ${t.dataset.unit}`;return` ${t.dataset.label}: ${t.formattedValue}${e}`},c.Z.defaults.scales.linear.title={display:!0},c.Z.defaults.scales.linear.ticks.callback=t=>t.toLocaleString().padStart(5),c.Z.defaults.scales.linear.ticks.font={family:"monospace"},c.Z.defaults.scales.linear.beginAtZero=!0,c.Z.defaults.scales.time.adapters.date={locale:u.Z},c.Z.defaults.scales.time.time.unit="day",c.Z.defaults.scales.time.time.displayFormats.day="M/d/yy",c.Z.defaults.scales.time.time.tooltipFormat="PPP",c.Z.defaults.scales.time.suggestedMin=e.start,c.Z.defaults.scales.time.suggestedMax=e.end,c.Z.defaults.spanGaps=!1}(0,t),g.push(await async function(t,e){const a={type:"line",data:{datasets:[{...t[39481],label:"LWL-19",borderColor:d[39481]},{...t[39485],label:"LWL-20A",borderColor:d[39485]},{...t["John's Island"],label:"John's Island",borderColor:d["John's Island"]},{...t["Munyon Island"],label:"Munyon Island",borderColor:d["Munyon Island"]}]},options:{plugins:{title:{text:"Salinity Envelope"},annotation:{annotations:{salinityEnvelope:{drawTime:"beforeDraw",type:"box",xMin:e.start,xMax:e.end,yMin:15,yMax:25,backgroundColor:d.salinityEnvelope,borderWidth:0}}}},scales:{x:{type:"time"},y:{type:"linear",title:{text:"Daily Average Salinity (PSU)"}},right:{type:"linear",position:"right",title:{text:" "},grid:{drawOnChartArea:!1,tickWidth:0},ticks:{callback:()=>"     "}}}}};return new c.Z(document.getElementById("salinityChart"),a)}(e,t)),g.push(await async function(t){const e={type:"line",data:{datasets:[{...t[91602],label:"S-44 (C-17)",borderColor:d[91602]},{...t[91404],label:"S-155 (C-51)",borderColor:d[91404]},{...t[91601],label:"S-41 (C-16)",borderColor:d[91601]}]},options:{plugins:{title:{text:"Canal Flow"}},scales:{x:{type:"time"},y:{type:"linear",title:{text:"Daily Average Flow Rate (cfs)"}},right:{type:"linear",position:"right",title:{text:" "},grid:{drawOnChartArea:!1,tickWidth:0},ticks:{callback:()=>"     "}}}}};return new c.Z(document.getElementById("flowChart"),e)}(e)),g.push(await async function(t){const e={type:"line",data:{datasets:[{...t["John's Island"],label:"Salinity",borderColor:d["John's Island"],yAxisID:"ySalinity"},{...t[91404],label:"Flow",borderColor:d[91404],yAxisID:"yFlow"}]},options:{plugins:{title:{text:"John's Island (C-51)"}},scales:{x:{type:"time"},ySalinity:{type:"linear",title:{text:"Daily Average Salinity (PSU)"}},yFlow:{type:"linear",position:"right",title:{text:"Daily Average Flow Rate (cfs)"},grid:{drawOnChartArea:!1},ticks:{callback:t=>t.toLocaleString().padEnd(5)}}}}};return new c.Z(document.getElementById("johnsIslandChart"),e)}(e)),g.push(await async function(t){const e=t[91602].total+t[91404].total+t[91601].total,a={type:"pie",data:{labels:["S-44 (C-17)","S-155 (C-51)","S-41 (C-16)"],datasets:[{data:[t[91602].total,t[91404].total,t[91601].total],backgroundColor:[d[91602],d[91404],d[91601]]}]},options:{interaction:{mode:"nearest",intersect:!0},plugins:{title:{text:"Relative Input"},tooltip:{callbacks:{label:t=>` ${t.label}: ${t.raw.toLocaleString("en",{maximumFractionDigits:0})} acre-feet (${(t.raw/e).toLocaleString("en",{style:"percent"})})`}},legend:{position:"right",labels:{boxHeight:p.kL.defaults.font.size,boxWidth:p.kL.defaults.font.size}}}}};return new p.kL(document.getElementById("contributionChart"),a)}(e)))};async function w(){await m(this.value)}!async function(){r().accessToken="pk.eyJ1IjoiY2NhcnN0ZTIiLCJhIjoiY2tucnl1bnc0MG1qMTJucGdtbXp2OHF4YiJ9.crUb_TvYaKNEGatz6lcQDw";const t=new(r().Map)({container:"map",style:"mapbox://styles/mapbox/outdoors-v11",bounds:new(r().LngLatBounds)(new(r().LngLat)(-80.07,26.51),new(r().LngLat)(-80.03,26.87)),pitchWithRotate:!1,boxZoom:!1,dragRotate:!1,touchPitch:!1});t.touchZoomRotate.disableRotation(),t.addControl(new(r().NavigationControl)({showCompass:!1})),(await fetch("/api/sites").then((t=>t.json()))).forEach((e=>{const a=(new(r().Popup)).setHTML(`<p><strong>${e.name}</strong></p><p>${e.type}</p>`),n={};null!=e.dbkey&&Object.keys(d).includes(e.dbkey)?n.color=d[e.dbkey]:n.color="#ccc",new(r().Marker)(n).setLngLat(e.geometry.coordinates).setPopup(a).addTo(t)}))}(),m(),b.forEach((t=>{t.addEventListener("change",w)}))}},a={};function n(t){var s=a[t];if(void 0!==s)return s.exports;var o=a[t]={exports:{}};return e[t].call(o.exports,o,o.exports,n),o.exports}n.m=e,t=[],n.O=(e,a,s,o)=>{if(!a){var l=1/0;for(d=0;d<t.length;d++){for(var[a,s,o]=t[d],i=!0,r=0;r<a.length;r++)(!1&o||l>=o)&&Object.keys(n.O).every((t=>n.O[t](a[r])))?a.splice(r--,1):(i=!1,o<l&&(l=o));i&&(t.splice(d--,1),e=s())}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[a,s,o]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};n.O.j=e=>0===t[e];var e=(e,a)=>{var s,o,[l,i,r]=a,d=0;for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(r)var c=r(n);for(e&&e(a);d<l.length;d++)o=l[d],n.o(t,o)&&t[o]&&t[o][0](),t[l[d]]=0;return n.O(c)},a=self.webpackChunkwq_dashboard=self.webpackChunkwq_dashboard||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})();var s=n.O(void 0,[216],(()=>n(982)));s=n.O(s)})();